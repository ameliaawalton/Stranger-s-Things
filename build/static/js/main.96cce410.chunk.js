(this["webpackJsonpuse-params-demo"]=this["webpackJsonpuse-params-demo"]||[]).push([[0],{31:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r(18),a=r.n(c),s=r(8),o=r(11),u=r(7),i=r.n(u),j=r(9),l=r(2),b="https://strangers-things.herokuapp.com/api/2104-ECE-RM-WEB-PT/",p=function(){var e=Object(j.a)(i.a.mark((function e(t){var r,n,c,a,s,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.url,n=t.method,c=t.token,a=t.body,console.log("callApi: ",{url:r,method:n,token:c,body:a}),e.prev=2,s={method:n?n.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},c&&(s.headers.Authorization="Bearer ".concat(c)),console.log("request URL: ",b+r),e.next=8,fetch(b+r,s);case 8:return o=e.sent,e.next=11,o.json();case 11:if(u=e.sent,console.log("data: ",u),!u.error){e.next=15;break}throw u.error;case 15:return e.abrupt("return",u);case 18:e.prev=18,e.t0=e.catch(2),console.error("ERROR: ",e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}(),h=r(1),d=function(){var e=Object(j.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p({url:"/users/me",token:t});case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)({}),u=Object(o.a)(a,2),b=u[0],p=u[1],O=void 0!==b.username;return Object(n.useEffect)(Object(j.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=3;break}return c(localStorage.getItem("st-token")),e.abrupt("return");case 3:return e.next=5,d(r);case 5:t=e.sent,p(t);case 7:case"end":return e.stop()}}),e)}))),[r]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:"Stranger's Things"}),Object(h.jsx)(l.a,{exact:!0,path:"/",children:O?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{children:["Hello, ",b.username]}),Object(h.jsx)("button",{onClick:function(){localStorage.removeItem("st-token"),c(""),p({})},children:"Log Out"})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{children:Object(h.jsx)(s.b,{to:"/register",children:"Register"})}),Object(h.jsx)("button",{children:Object(h.jsx)(s.b,{to:"/login",children:"Login"})})]})}),Object(h.jsx)(l.a,{path:"/register",children:Object(h.jsx)(x,{action:"register",setToken:c})}),Object(h.jsx)(l.a,{path:"/login",children:Object(h.jsx)(x,{action:"login",setToken:c})})]})},x=function(e){var t=e.action,r=e.setToken,c=Object(n.useState)(""),a=Object(o.a)(c,2),u=a[0],b=a[1],d=Object(n.useState)(""),O=Object(o.a)(d,2),x=O[0],g=O[1],f="login"===t,m=f?"Login":"Register",v=f?"register":"login",k=f?"Register":"Login",w=Object(l.e)(),y=function(){var e=Object(j.a)(i.a.mark((function e(n){var c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,p({url:"users/".concat(t),body:{user:{username:u,password:x}},method:"POST"});case 3:c=e.sent,(a=c.data.token)&&(localStorage.setItem("st-token",a),r(a),w.push("/"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h2",{children:m}),Object(h.jsxs)("form",{onSubmit:y,children:[Object(h.jsx)("input",{type:"text",placeholder:"username",required:!0,value:u,onChange:function(e){return b(e.target.value)}}),Object(h.jsx)("input",{type:"password",placeholder:"password",value:x,onChange:function(e){return g(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:m})]}),Object(h.jsx)("button",{children:Object(h.jsx)(s.b,{to:"/".concat(v),children:k})}),Object(h.jsx)("button",{children:Object(h.jsx)(s.b,{to:"/",children:"Home"})})]})};a.a.render(Object(h.jsx)(s.a,{children:Object(h.jsx)(O,{})}),document.querySelector("#app"))}},[[31,1,2]]]);
//# sourceMappingURL=main.96cce410.chunk.js.map